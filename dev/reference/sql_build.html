<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Build and render SQL from a sequence of lazy operations — lazy_multi_join_query • dbplyr</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Build and render SQL from a sequence of lazy operations — lazy_multi_join_query"><meta name="description" content="sql_build() creates a select_query S3 object, that is rendered
to a SQL string by sql_render(). The output from sql_build() is
designed to be easy to test, as it's database agnostic, and has
a hierarchical structure. Outside of testing, however, you should
always call sql_render()."><meta property="og:description" content="sql_build() creates a select_query S3 object, that is rendered
to a SQL string by sql_render(). The output from sql_build() is
designed to be easy to test, as it's database agnostic, and has
a hierarchical structure. Outside of testing, however, you should
always call sql_render()."><meta property="og:image" content="https://dbplyr.tidyverse.org/logo.png"><meta name="robots" content="noindex"><script defer data-domain="dbplyr.tidyverse.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dbplyr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.5.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/dbplyr.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/backend-2.html">dbplyr 2.0.0 backend API</a></li>
    <li><a class="dropdown-item" href="../articles/new-backend.html">Adding a new DBI backend</a></li>
    <li><a class="dropdown-item" href="../articles/reprex.html">Reprexes for dbplyr</a></li>
    <li><a class="dropdown-item" href="../articles/sql.html">Writing SQL with dbplyr</a></li>
    <li><a class="dropdown-item" href="../articles/translation-function.html">Function translation</a></li>
    <li><a class="dropdown-item" href="../articles/translation-verb.html">Verb translation</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2024/04/dbplyr-2-5-0/">Version 2.5.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2023/10/dbplyr-2-4-0/">Version 2.4.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2023/01/dbplyr-2-3-0/">Version 2.3.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2022/06/dbplyr-2-2-0/">Version 2.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2021/02/dplyr-backends/">Version 2.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2020/11/dbplyr-2-0-0/">Version 2.0.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2019/04/dbplyr-1-4-0/">Version 1.4.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2019/01/dbplyr-1-3-0/">Version 1.3.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/01/dbplyr-1-2/">Version 1.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://blog.rstudio.com/2017/06/27/dbplyr-1-1-0/">Version 1.1.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidyverse/dbplyr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Build and render SQL from a sequence of lazy operations</h1>
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/dbplyr/blob/main/R/lazy-join-query.R" class="external-link"><code>R/lazy-join-query.R</code></a>, <a href="https://github.com/tidyverse/dbplyr/blob/main/R/lazy-query.R" class="external-link"><code>R/lazy-query.R</code></a>, <a href="https://github.com/tidyverse/dbplyr/blob/main/R/lazy-select-query.R" class="external-link"><code>R/lazy-select-query.R</code></a>, and 6 more</small>
      <div class="d-none name"><code>sql_build.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>sql_build()</code> creates a <code>select_query</code> S3 object, that is rendered
to a SQL string by <code>sql_render()</code>. The output from <code>sql_build()</code> is
designed to be easy to test, as it's database agnostic, and has
a hierarchical structure. Outside of testing, however, you should
always call <code>sql_render()</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lazy_multi_join_query</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">joins</span>,</span>
<span>  <span class="va">table_names</span>,</span>
<span>  <span class="va">vars</span>,</span>
<span>  group_vars <span class="op">=</span> <span class="fu"><a href="lazy_ops.html">op_grps</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  order_vars <span class="op">=</span> <span class="fu"><a href="lazy_ops.html">op_sort</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  frame <span class="op">=</span> <span class="fu"><a href="lazy_ops.html">op_frame</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  call <span class="op">=</span> <span class="fu">caller_env</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lazy_rf_join_query</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">type</span>,</span>
<span>  <span class="va">by</span>,</span>
<span>  <span class="va">table_names</span>,</span>
<span>  <span class="va">vars</span>,</span>
<span>  group_vars <span class="op">=</span> <span class="fu"><a href="lazy_ops.html">op_grps</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  order_vars <span class="op">=</span> <span class="fu"><a href="lazy_ops.html">op_sort</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  frame <span class="op">=</span> <span class="fu"><a href="lazy_ops.html">op_frame</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  call <span class="op">=</span> <span class="fu">caller_env</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lazy_semi_join_query</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">vars</span>,</span>
<span>  <span class="va">anti</span>,</span>
<span>  <span class="va">by</span>,</span>
<span>  <span class="va">where</span>,</span>
<span>  group_vars <span class="op">=</span> <span class="fu"><a href="lazy_ops.html">op_grps</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  order_vars <span class="op">=</span> <span class="fu"><a href="lazy_ops.html">op_sort</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  frame <span class="op">=</span> <span class="fu"><a href="lazy_ops.html">op_frame</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  call <span class="op">=</span> <span class="fu">caller_env</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lazy_query</span><span class="op">(</span></span>
<span>  <span class="va">query_type</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  group_vars <span class="op">=</span> <span class="fu"><a href="lazy_ops.html">op_grps</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  order_vars <span class="op">=</span> <span class="fu"><a href="lazy_ops.html">op_sort</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  frame <span class="op">=</span> <span class="fu"><a href="lazy_ops.html">op_frame</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lazy_select_query</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  where <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  having <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  order_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  limit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  distinct <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  group_vars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  order_vars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  frame <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  select_operation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"select"</span>, <span class="st">"mutate"</span>, <span class="st">"summarise"</span><span class="op">)</span>,</span>
<span>  message_summarise <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lazy_set_op_query</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">type</span>, <span class="va">all</span>, call <span class="op">=</span> <span class="fu">caller_env</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lazy_union_query</span><span class="op">(</span><span class="va">x</span>, <span class="va">unions</span>, call <span class="op">=</span> <span class="fu">caller_env</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">sql_build</span><span class="op">(</span><span class="va">op</span>, con <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span>, sql_options <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">sql_render</span><span class="op">(</span></span>
<span>  <span class="va">query</span>,</span>
<span>  con <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  sql_options <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subquery <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  lvl <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">sql_optimise</span><span class="op">(</span><span class="va">x</span>, con <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span>, subquery <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">join_query</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">select</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"inner"</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".x"</span>, <span class="st">".y"</span><span class="op">)</span>,</span>
<span>  na_matches <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">select_query</span><span class="op">(</span></span>
<span>  <span class="va">from</span>,</span>
<span>  select <span class="op">=</span> <span class="fu"><a href="sql.html">sql</a></span><span class="op">(</span><span class="st">"*"</span><span class="op">)</span>,</span>
<span>  where <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  having <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  window <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  order_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  limit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  distinct <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  from_alias <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">semi_join_query</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">vars</span>,</span>
<span>  anti <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  where <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na_matches <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set_op_query</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">type</span>, all <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">union_query</span><span class="op">(</span><span class="va">x</span>, <span class="va">unions</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed on to the methods. Not currently used.</p></dd>


<dt id="arg-op">op<a class="anchor" aria-label="anchor" href="#arg-op"></a></dt>
<dd><p>A sequence of lazy operations</p></dd>


<dt id="arg-con">con<a class="anchor" aria-label="anchor" href="#arg-con"></a></dt>
<dd><p>A database connection. The default <code>NULL</code> uses a set of
rules that should be very similar to ANSI 92, and allows for testing
without an active database connection.</p></dd>


<dt id="arg-sql-options">sql_options<a class="anchor" aria-label="anchor" href="#arg-sql-options"></a></dt>
<dd><p>SQL rendering options generated by <code><a href="sql_options.html">sql_options()</a></code>.</p></dd>


<dt id="arg-subquery">subquery<a class="anchor" aria-label="anchor" href="#arg-subquery"></a></dt>
<dd><p>Is this SQL going to be used in a subquery?
This is important because you can place a bare table name in a subquery
and  ORDER BY does not work in subqueries.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>sql_build()</code> is generic over the lazy operations, <a href="lazy_ops.html">lazy_ops</a>,
and generates an S3 object that represents the query. <code>sql_render()</code>
takes a query object and then calls a function that is generic
over the database. For example, <code>sql_build.op_mutate()</code> generates
a <code>select_query</code>, and <code>sql_render.select_query()</code> calls
<code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html" class="external-link">sql_select()</a></code>, which has different methods for different databases.
The default methods should generate ANSI 92 SQL where possible, so you
backends only need to override the methods if the backend is not ANSI
compliant.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, Maximilian Girlich, Edgar Ruiz, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer></body></html>

