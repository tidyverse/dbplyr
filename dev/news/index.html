<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Changelog • dbplyr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

<!-- Bootstrap -->
<link href="../tidyverse.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>
<link href="../tidyverse-2.css" rel="stylesheet">

<!--optional theme-->
<link href="../.css" rel="stylesheet">




<meta property="og:title" content="Changelog" />
<meta property="og:image" content="https://dbplyr.tidyverse.org/logo.png" />
<meta name="twitter:card" content="summary" />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>

  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-news">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">dbplyr</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of the <a href="https://tidyverse.org">tidyverse</a></span>
          <span class="version version-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.99.0.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../articles/dbplyr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/backend-2.html">dplyr 2.0.0 transition guide</a>
    </li>
    <li>
      <a href="../articles/new-backend.html">Adding a new DBI backend</a>
    </li>
    <li>
      <a href="../articles/reprex.html">Reprexes for dbplyr</a>
    </li>
    <li>
      <a href="../articles/sql.html">Writing SQL with dbplyr</a>
    </li>
    <li>
      <a href="../articles/translation-function.html">Function translation</a>
    </li>
    <li>
      <a href="../articles/translation-verb.html">Verb translation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/04/dbplyr-1-4-0/">Version 1.4.0</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/01/dbplyr-1-3-0/">Version 1.3.0</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2018/01/dbplyr-1-2/">Version 1.2.0</a>
    </li>
    <li>
      <a href="https://blog.rstudio.com/2017/06/27/dbplyr-1-1-0/">Version 1.1.0</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
        <li>
  <a href="https://github.com/tidyverse/dbplyr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
      <h1 data-toc-skip>Changelog <small></small></h1>
      <small>Source: <a href='https://github.com/tidyverse/dbplyr/blob/master/NEWS.md'><code>NEWS.md</code></a></small>
    </div>

    <div id="dbplyr-development-version" class="section level1">
<h1 class="page-header" data-toc-text="development version">
<a href="#dbplyr-development-version" class="anchor"></a>dbplyr (development version)<small> Unreleased </small>
</h1>
<ul>
<li><p>Oracle translation now depends on Oracle 12c, and uses a “row-limiting” clause for <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>.</p></li>
<li><p><code><a href="../reference/join_query.html">sql_optimise()</a></code> now can partially optimise a pipeline; due to an unfortunate bug it previously gave up too easily.</p></li>
<li><p>dbplyr no longer creates an <code>ORDER</code> BY clause in subqueries. This is not part of the SQL spec, and has very limited support across databases. Now such queries generate a warning suggesting that you move your <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code> call later in the pipeline (<a href='https://github.com/tidyverse/dbplyr/issues/276'>#276</a>). (There’s one exception: <code>ORDER BY</code> is still generated if <code>LIMIT</code> is present.)</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_min()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max()</a></code>, and <code>slice_order()</code> are now supported. <code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_tail()</a></code> throw clear error messages (<a href='https://github.com/tidyverse/dbplyr/issues/394'>#394</a>)</p></li>
<li><p><code><a href="../reference/window_order.html">window_order()</a></code> overrides ordering, rather than appending to it.</p></li>
<li><p>Now supports <code><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate()</a></code> from dplyr 1.0.0 (<a href='https://github.com/tidyverse/dbplyr/issues/494'>#494</a>).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">sql_escape_ident()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">sql_escape_string()</a></code> generics from dbplyr are no longer used; these methods should now be supplied for <code><a href="https://dbi.r-dbi.org/reference/dbQuoteIdentifier.html">DBI::dbQuoteIdentifier()</a></code> and <code><a href="https://dbi.r-dbi.org/reference/dbQuoteString.html">DBI::dbQuoteString()</a></code> respectively.</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute()</a></code> now correctly tracks variables it needs when creating subqueries (<a href='https://github.com/tidyverse/dbplyr/issues/313'>#313</a>).</p></li>
<li><p>New <code><a href="../reference/db_sql.html">sql_join_suffix()</a></code> allows backends to control the default suffixes used (<a href='https://github.com/tidyverse/dbplyr/issues/254'>#254</a>).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct()</a></code> no longer duplicates column if grouped (<a href='https://github.com/tidyverse/dbplyr/issues/354'>#354</a>).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> grouping variables no longer generates a downstream error (<a href='https://github.com/tidyverse/dbplyr/issues/396'>#396</a>)</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> correctly generates subqueries when you re-use the same variable three or more times (<a href='https://github.com/tidyverse/dbplyr/issues/412'>#412</a>).</p></li>
<li><p>Each individual element of <code><a href="../reference/in_schema.html">in_schema()</a></code> is now correctly quoted (<a href='https://github.com/tidyverse/dbplyr/issues/287'>#287</a>). (use <code><a href="../reference/sql.html">sql()</a></code> to opt out of quoting, if needed). And <code><a href="https://dbi.r-dbi.org/reference/Id.html">DBI::Id()</a></code> should work anywhere that <code><a href="../reference/in_schema.html">in_schema()</a></code> does.</p></li>
<li><p>Can now <code><a href="https://dplyr.tidyverse.org/reference/copy_to.html">copy_to()</a></code> can now <code>overwrite</code> when table is specified with schema (<a href='https://github.com/tidyverse/dbplyr/issues/489'>#489</a>).</p></li>
<li>
<p>A number of <code>db_*</code> generics have been replaced with SQL generation generics:</p>
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_analyze()</a></code> -&gt; <code><a href="../reference/db_sql.html">sql_table_analyze()</a></code>
</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_create_index()</a></code> -&gt; <code><a href="../reference/db_sql.html">sql_index_create()</a></code>
</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_explain()</a></code> -&gt; <code>sql_queriy_explain()</code>
</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_query_fields()</a></code> -&gt; <code><a href="../reference/db_sql.html">sql_query_fields()</a></code>
</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_query_rows()</a></code> -&gt; <code><a href="../reference/db_sql.html">sql_query_rows()</a></code>
</li>
</ul>
<p>This makes them easier to test and is an important part of the process of moving all database generics in dbplyr (<a href='https://github.com/tidyverse/dbplyr/issues/284'>#284</a>).</p>
</li>
<li><p>A number of <code>db_*</code> generics are no longer used: <code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_create_indexes()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_begin()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_rollback()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_commit()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_list_tables()</a></code>, <code>drop_drop_table()</code>, <code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_has_table()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_create_table()</a></code>, <code>db_data_types()</code>. These were only used for data insertion, and that now all happens via <code><a href="https://dbi.r-dbi.org/reference/dbWriteTable.html">dbWriteTable()</a></code>.</p></li>
<li><p>MySQL uses standard SQL for index creation.</p></li>
<li><p>MS SQL translation does better a distinguishing between bit and boolean (<a href='https://github.com/tidyverse/dbplyr/issues/377'>#377</a>, <a href='https://github.com/tidyverse/dbplyr/issues/318'>#318</a>). <code>if</code> and <code>ifelse</code> once again generate <code>IIF</code>, creating simpler expressions.</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/copy_to.html">copy_to()</a></code> gains an <code>in_transaction</code> argument so you can optionally suppress the transaction wrapper (<a href='https://github.com/tidyverse/dbplyr/issues/368'>#368</a>).</p></li>
<li><p>The join functions now error when additional arguments are provided (instead of silently swallowing them!) (<a href='https://github.com/tidyverse/dbplyr/issues/382'>#382</a>).</p></li>
<li><p><code><a href="https://rdrr.io/r/base/substr.html">substring()</a></code> is now translated the same way as <code><a href="https://rdrr.io/r/base/substr.html">substr()</a></code> (<a href='https://github.com/tidyverse/dbplyr/issues/378'>#378</a>).</p></li>
<li><p><code><a href="https://rdrr.io/r/base/Extremes.html">pmin()</a></code> and <code><a href="https://rdrr.io/r/base/Extremes.html">pmax()</a></code> translations now have <code>na.rm</code> arguments (<a href='https://github.com/tidyverse/dbplyr/issues/479'>#479</a>). All <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code> and <code><a href="https://rdrr.io/r/stats/cor.html">var()</a></code> translations have <code>na.rm</code>. All warn on first use for consistency with <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> and friends.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/Arithmetic.html">%/%</a></code> now generates a clear error message; previously it was translated to <code><a href="https://rdrr.io/r/base/Arithmetic.html">/</a></code> which is not correct (<a href='https://github.com/tidyverse/dbplyr/issues/108'>#108</a>).</p></li>
<li><p>SQLite gains translations for lubridate functions <code>today()</code>, <code>now()</code>, <code>year()</code>, <code>month()</code>, <code>day()</code>, <code>hour()</code>, <code>minute()</code>, <code>second()</code>,<code>yday()</code> (<a href='https://github.com/tidyverse/dbplyr/issues/262'>#262</a>).</p></li>
<li><p>You can now use <code><a href="https://rdrr.io/r/base/ns-dblcolon.html">::</a></code> in translations, so that (e.g.) <code><a href="https://dplyr.tidyverse.org/reference/context.html">dbplyr::n()</a></code> is translated to <code>count(*)</code> (<a href='https://github.com/tidyverse/dbplyr/issues/207'>#207</a>).</p></li>
<li>
<p>New RedShift translations when used with <code>RPostgres::Redshift()</code>.</p>
<ul>
<li><p><code>str_replace()</code> errors since there’s no Redshift translation, and <code>str_replace_all()</code> uses <code>REGEXP_REPLACE()</code> (<a href='https://github.com/tidyverse/dbplyr/issues/446'>#446</a>).</p></li>
<li><p><code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> and <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code> use <code><a href="https://rdrr.io/r/base/Logic.html">||</a></code> (<a href='https://github.com/tidyverse/dbplyr/issues/458'>#458</a>).</p></li>
<li><p><code><a href="https://rdrr.io/r/base/numeric.html">as.numeric()</a></code> and <code><a href="https://rdrr.io/r/base/double.html">as.double()</a></code> cast to <code>FLOAT</code> (<a href='https://github.com/tidyverse/dbplyr/issues/408'>#408</a>).</p></li>
<li><p><code><a href="https://rdrr.io/r/base/substr.html">substr()</a></code> and <code>str_sub()</code> use <code>SUBSTRING()</code> (<a href='https://github.com/tidyverse/dbplyr/issues/327'>#327</a>).</p></li>
</ul>
</li>
<li><p><code>sql_translate_env.Microsoft SQL Server()</code> now uses <code><a href="../reference/sql_substr.html">sql_try_cast()</a></code> instead of <code><a href="../reference/sql_substr.html">sql_cast()</a></code> for MSSQL version 11+ (2012+) (<a href='https://github.com/DavidPatShuiFong'>@DavidPatShuiFong</a>, <a href='https://github.com/tidyverse/dbplyr/issues/380'>#380</a>).</p></li>
<li><p>SQLite gets correct translation for <code><a href="https://rdrr.io/r/stats/median.html">median()</a></code> (<a href='https://github.com/tidyverse/dbplyr/issues/357'>#357</a>).</p></li>
<li><p><code><a href="../reference/lahman.html">copy_lahman()</a></code> and <code><a href="../reference/nycflights13.html">copy_nycflights13()</a></code> (and hence <code><a href="../reference/nycflights13.html">nycflights13_sqlite()</a></code>) and friends now return DBI connections rather than the now deprecated <code><a href="../reference/src_dbi.html">src_dbi()</a></code> (<a href='https://github.com/tidyverse/dbplyr/issues/440'>#440</a>).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_drop_table()</a></code> now works for Oracle (<a href='https://github.com/tidyverse/dbplyr/issues/353'>#353</a>).</p></li>
<li><p>The default translation for <code><a href="https://dplyr.tidyverse.org/reference/context.html">n()</a></code> is now <code>count(*)</code> (<a href='https://github.com/tidyverse/dbplyr/issues/343'>#343</a>).</p></li>
<li><p>odbc no longer translates <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code>.</p></li>
<li><p>Subquery names are now scoped within the query. This means that query text should now be deterministic which helps some query optimisers/cachers (<a href='https://github.com/tidyverse/dbplyr/issues/336'>#336</a>).</p></li>
<li><p><code>sub_str()</code> translation is more consistent in edge cases (<a href='https://github.com/ianmcook'>@ianmcook</a>).</p></li>
<li><p>Postgres: New translations for stringr functions: <code>str_squish()</code>, <code>str_remove()</code>, <code>str_remove_all()</code> (<a href='https://github.com/shosaco'>@shosaco</a>).</p></li>
<li><p>All old lazy eval shims have been removed.</p></li>
<li><p><code><a href="https://rdrr.io/r/stats/median.html">median()</a></code> now takes a new argument <code>na.rm</code> for consistency with <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code>, but still does always remove any missing values (<a href='https://github.com/lorenzwalthert'>@lorenzwalthert</a>, <a href='https://github.com/tidyverse/dbplyr/issues/483'>#483</a>).</p></li>
<li><p><a href="https://blob.tidyverse.org/">blob</a> vectors can now be used with <code>!!</code> and <code>!!!</code> operators, for example in <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> (<a href='https://github.com/okhoma'>@okhoma</a>, <a href='https://github.com/tidyverse/dbplyr/issues/433'>#433</a>)</p></li>
</ul>
</div>
    <div id="dbplyr-144" class="section level1">
<h1 class="page-header" data-toc-text="1.4.4">
<a href="#dbplyr-144" class="anchor"></a>dbplyr 1.4.4<small> 2020-05-27 </small>
</h1>
<ul>
<li><p>Internally <code><a href="https://dbi.r-dbi.org/reference/dbExecute.html">DBI::dbExecute()</a></code> now uses <code>immediate = TRUE</code>; this improves support for session-scoped temporary tables in MS SQL (<a href='https://github.com/krlmlr'>@krlmlr</a>, <a href='https://github.com/tidyverse/dbplyr/issues/438'>#438</a>).</p></li>
<li><p>Subqueries with <code>ORDER BY</code> use <code>TOP 9223372036854775807</code> instead of <code>TOP 100 PERCENT</code> on SQL Server for compatibility with Azure Data Warehouse (<a href='https://github.com/tidyverse/dbplyr/issues/337'>#337</a>, <a href='https://github.com/alexkyllo'>@alexkyllo</a>).</p></li>
<li><p><code><a href="../reference/escape.html">escape()</a></code> now supports <code>blob</code> vectors using new <code><a href="../reference/sql_escape_logical.html">sql_escape_raw()</a></code> generic. It enables using <a href="https://blob.tidyverse.org/">blob</a> variables in dplyr verbs, for example to filter nvarchar values by UTF-16 blobs (see <a href="https://github.com/r-dbi/DBI/issues/215#issuecomment-356376133" class="uri">https://github.com/r-dbi/DBI/issues/215#issuecomment-356376133</a>). (<a href='https://github.com/okhoma'>@okhoma</a>, <a href='https://github.com/tidyverse/dbplyr/issues/433'>#433</a>)</p></li>
<li><p>Added <code>setOldClass()</code> calls for <code>"ident"</code> and <code>"ident_q"</code> classes for compatibility with dplyr 1.0.0 (<a href='https://github.com/tidyverse/dbplyr/issues/448'>#448</a>, <a href='https://github.com/krlmlr'>@krlmlr</a>).</p></li>
<li><p>Postgres <code>str_detect()</code> translation uses same argument names as stringr, and gains a <code>negate</code> argument (<a href='https://github.com/tidyverse/dbplyr/issues/444'>#444</a>).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">semi_join()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">anti_join()</a></code> now correctly support the <code>sql_on</code> argument (<a href='https://github.com/tidyverse/dbplyr/issues/443'>#443</a>, <a href='https://github.com/krlmlr'>@krlmlr</a>).</p></li>
</ul>
</div>
    <div id="dbplyr-143" class="section level1">
<h1 class="page-header" data-toc-text="1.4.3">
<a href="#dbplyr-143" class="anchor"></a>dbplyr 1.4.3<small> 2020-04-19 </small>
</h1>
<ul>
<li><p>dbplyr now uses RPostgres (instead of RPostgreSQL) and RMariaDB (instead of RMySQL) for its internal tests and data functions (<a href='https://github.com/tidyverse/dbplyr/issues/427'>#427</a>).</p></li>
<li><p>The Date and POSIXt methods for <code><a href="../reference/escape.html">escape()</a></code> now use exported <code><a href="../reference/sql_escape_logical.html">sql_escape_date()</a></code> and <code><a href="../reference/sql_escape_logical.html">sql_escape_datetime()</a></code> generics to allow backend specific formatting of date and datetime literals. These are used to provide methods for Athena and Presto backends (<a href='https://github.com/OssiLehtinen'>@OssiLehtinen</a>, <a href='https://github.com/tidyverse/dbplyr/issues/384'>#384</a>, <a href='https://github.com/tidyverse/dbplyr/issues/391'>#391</a>).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/nth.html">first()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/nth.html">last()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/nth.html">nth()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lead()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag()</a></code> now respect the <code><a href="../reference/window_order.html">window_frame()</a></code> (<a href='https://github.com/krlmlr'>@krlmlr</a>, <a href='https://github.com/tidyverse/dbplyr/issues/366'>#366</a>).</p></li>
<li><p>SQL server: new translations for <code>str_flatten()</code> (<a href='https://github.com/PauloJhonny'>@PauloJhonny</a>, <a href='https://github.com/tidyverse/dbplyr/issues/405'>#405</a>).</p></li>
<li><p>SQL server: temporary datasets are now session-local, not global (<a href='https://github.com/tidyverse/dbplyr/issues/401'>#401</a>).</p></li>
<li><p>Postgres: correct <code>str_detect()</code>, <code>str_replace()</code> and <code>str_replace_all()</code> translation (<a href='https://github.com/shosaco'>@shosaco</a>, <a href='https://github.com/tidyverse/dbplyr/issues/362'>#362</a>).</p></li>
</ul>
</div>
    <div id="dbplyr-142" class="section level1">
<h1 class="page-header" data-toc-text="1.4.2">
<a href="#dbplyr-142" class="anchor"></a>dbplyr 1.4.2<small> 2019-06-17 </small>
</h1>
<ul>
<li><p>Fix bug when partially evaluating unquoting quosure containing a single symbol (<a href='https://github.com/tidyverse/dbplyr/issues/317'>#317</a>)</p></li>
<li><p>Fixes for rlang and dpylr compatibility.</p></li>
</ul>
</div>
    <div id="dbplyr-141" class="section level1">
<h1 class="page-header" data-toc-text="1.4.1">
<a href="#dbplyr-141" class="anchor"></a>dbplyr 1.4.1<small> 2019-06-05 </small>
</h1>
<p>Minor improvements to SQL generation</p>
<ul>
<li><p><code>x %in% y</code> strips names of <code>y</code> (<a href='https://github.com/tidyverse/dbplyr/issues/269'>#269</a>).</p></li>
<li><p>Enhancements for scoped verbs (<code><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_if()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/filter_all.html">filter_at()</a></code> etc) (<a href='https://github.com/tidyverse/dbplyr/issues/296'>#296</a>, <a href='https://github.com/tidyverse/dbplyr/issues/306'>#306</a>).</p></li>
<li><p>MS SQL use <code>TOP 100 PERCENT</code> as stop-gap to allow subqueries with <code>ORDER BY</code> (<a href='https://github.com/tidyverse/dbplyr/issues/277'>#277</a>).</p></li>
<li><p>Window functions now translated correctly for Hive (<a href='https://github.com/tidyverse/dbplyr/issues/293'>#293</a>, <a href='https://github.com/cderv'>@cderv</a>).</p></li>
</ul>
</div>
    <div id="dbplyr-140" class="section level1">
<h1 class="page-header" data-toc-text="1.4.0">
<a href="#dbplyr-140" class="anchor"></a>dbplyr 1.4.0<small> 2019-04-23 </small>
</h1>
<div id="breaking-changes" class="section level2">
<h2 class="hasAnchor">
<a href="#breaking-changes" class="anchor"></a>Breaking changes</h2>
<ul>
<li><p><code>Error: `con` must not be NULL</code>: If you see this error, it probably means that you have forgotten to pass <code>con</code> down to a dbplyr function. Previously, dbplyr defaulted to using <code><a href="../reference/simulate_dbi.html">simulate_dbi()</a></code> which introduced subtle escaping bugs. (It’s also possible I have forgotten to pass it somewhere that the dbplyr tests don’t pick up, so if you can’t figure it out, please let me know).</p></li>
<li><p>Subsetting (<code><a href="https://rdrr.io/r/base/Extract.html">[[</a></code>, <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code>, and <code><a href="https://rdrr.io/r/base/Extract.html">[</a></code>) functions are no longer evaluated locally. This makes the translation more consistent and enables useful new idioms for modern databases (<a href='https://github.com/tidyverse/dbplyr/issues/200'>#200</a>).</p></li>
</ul>
</div>
<div id="new-features" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features" class="anchor"></a>New features</h2>
<ul>
<li><p>MySQL/MariaDB (<a href="https://mariadb.com/kb/en/library/window-functions/" class="uri">https://mariadb.com/kb/en/library/window-functions/</a>) and SQLite (<a href="https://www.sqlite.org/windowfunctions.html" class="uri">https://www.sqlite.org/windowfunctions.html</a>) translations gain support for window functions, available in Maria DB 10.2, MySQL 8.0, and SQLite 3.25 (<a href='https://github.com/tidyverse/dbplyr/issues/191'>#191</a>).</p></li>
<li>
<p>Overall, dplyr generates many fewer subqueries:</p>
<ul>
<li><p>Joins and semi-joins no longer add an unneeded subquery (<a href='https://github.com/tidyverse/dbplyr/issues/236'>#236</a>). This is facilitated by the new <code>bare_identifier_ok</code> argument to <code><a href="../reference/join_query.html">sql_render()</a></code>; the previous argument was called <code>root</code> and confused me.</p></li>
<li><p>Many sequences of <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>, and <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute()</a></code> can be collapsed into a single query, instead of always generating a subquery (<a href='https://github.com/tidyverse/dbplyr/issues/213'>#213</a>).</p></li>
</ul>
</li>
<li><p>New <code><a href="../articles/sql.html">vignette("sql")</a></code> describes some advantages of dbplyr over SQL (<a href='https://github.com/tidyverse/dbplyr/issues/205'>#205</a>) and gives some advice about writing literal SQL inside of dplyr, when you need to (<a href='https://github.com/tidyverse/dbplyr/issues/196'>#196</a>).</p></li>
<li><p>New <code><a href="../articles/reprex.html">vignette("reprex")</a></code> gives some hints on creating reprexes that work anywhere (<a href='https://github.com/tidyverse/dbplyr/issues/117'>#117</a>). This is supported by a new <code><a href="../reference/memdb_frame.html">tbl_memdb()</a></code> that matches the existing <code><a href="../reference/tbl_lazy.html">tbl_lazy()</a></code>.</p></li>
<li><p>All <code>..._join()</code> functions gain an <code>sql_on</code> argument that allows specifying arbitrary join predicates in SQL code (<a href='https://github.com/tidyverse/dbplyr/issues/146'>#146</a>, <a href='https://github.com/krlmlr'>@krlmlr</a>).</p></li>
</ul>
</div>
<div id="sql-translations" class="section level2">
<h2 class="hasAnchor">
<a href="#sql-translations" class="anchor"></a>SQL translations</h2>
<ul>
<li><p>New translations for some lubridate functions: <code>today()</code>, <code>now()</code>, <code>year()</code>, <code>month()</code>, <code>day()</code>, <code>hour()</code>, <code>minute()</code>, <code>second()</code>, <code>quarter()</code>, <code>yday()</code> (<a href='https://github.com/colearendt'>@colearendt</a>, <a href='https://github.com/derekmorr'>@derekmorr</a>). Also added new translation for <code><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct()</a></code>.</p></li>
<li><p>New translations for stringr functions: <code>str_c()</code>, <code>str_sub()</code>, <code>str_length()</code>, <code>str_to_upper()</code>, <code>str_to_lower()</code>, and <code>str_to_title()</code> (<a href='https://github.com/colearendt'>@colearendt</a>). Non-translated stringr functions throw a clear error.</p></li>
<li><p>New translations for bitwise operations: <code><a href="https://rdrr.io/r/base/bitwise.html">bitwNot()</a></code>, <code><a href="https://rdrr.io/r/base/bitwise.html">bitwAnd()</a></code>, <code><a href="https://rdrr.io/r/base/bitwise.html">bitwOr()</a></code>, <code><a href="https://rdrr.io/r/base/bitwise.html">bitwXor()</a></code>, <code><a href="https://rdrr.io/r/base/bitwise.html">bitwShiftL()</a></code>, and <code><a href="https://rdrr.io/r/base/bitwise.html">bitwShiftR()</a></code>. Unlike the base R functions, the translations do not coerce arguments to integers (<a href='https://github.com/davidchall'>@davidchall</a>, <a href='https://github.com/tidyverse/dbplyr/issues/235'>#235</a>).</p></li>
<li><p>New translation for <code>x[y]</code> to <code>CASE WHEN y THEN x END</code>. This enables <code><a href="https://rdrr.io/r/base/sum.html">sum(a[b == 0])</a></code> to work as you expect from R (<a href='https://github.com/tidyverse/dbplyr/issues/202'>#202</a>). <code>y</code> needs to be a logical expression; if not you will likely get a type error from your database.</p></li>
<li><p>New translations for <code>x$y</code> and <code>x[["y"]]</code> to <code>x.y</code>, enabling you to index into nested fields in databases that provide them (<a href='https://github.com/tidyverse/dbplyr/issues/158'>#158</a>).</p></li>
<li><p>The <code>.data</code> and <code>.env</code> pronouns of tidy evaluation are correctly translated (<a href='https://github.com/tidyverse/dbplyr/issues/132'>#132</a>).</p></li>
<li><p>New translation for <code><a href="https://rdrr.io/r/stats/median.html">median()</a></code> and <code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code>. Works for all ANSI compliant databases (SQL Server, Postgres, MariaDB, Teradata) and has custom translations for Hive. Thanks to <a href='https://github.com/edavidaja'>@edavidaja</a> for researching the SQL variants! (<a href='https://github.com/tidyverse/dbplyr/issues/169'>#169</a>)</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/na_if.html">na_if()</a></code> is correct translated to <code>NULLIF()</code> (rather than <code>NULL_IF</code>) (<a href='https://github.com/tidyverse/dbplyr/issues/211'>#211</a>).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct()</a></code> translation throws an error when given more than one argument. (<a href='https://github.com/tidyverse/dbplyr/issues/101'>#101</a>, <a href='https://github.com/tidyverse/dbplyr/issues/133'>#133</a>).</p></li>
<li><p>New default translations for <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code>, <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code>, and the hyperbolic functions (these previously were only available for ODBC databases).</p></li>
<li><p>Corrected translations of <code><a href="https://rdrr.io/r/base/Extremes.html">pmin()</a></code> and <code><a href="https://rdrr.io/r/base/Extremes.html">pmax()</a></code> to <code>LEAST()</code> and <code>GREATEST()</code> for ANSI compliant databases (<a href='https://github.com/tidyverse/dbplyr/issues/118'>#118</a>), to <code>MIN()</code> and <code>MAX()</code> for SQLite, and to an error for SQL server.</p></li>
<li><p>New translation for <code><a href="https://rdrr.io/r/base/switch.html">switch()</a></code> to the simple form of <code>CASE WHEN</code> (<a href='https://github.com/tidyverse/dbplyr/issues/192'>#192</a>).</p></li>
</ul>
<div id="sql-simulation" class="section level3">
<h3 class="hasAnchor">
<a href="#sql-simulation" class="anchor"></a>SQL simulation</h3>
<p>SQL simulation makes it possible to see what dbplyr will translate SQL to, without having an active database connection, and is used for testing and generating reprexes.</p>
<ul>
<li><p>SQL simulation has been overhauled. It now works reliably, is better documented, and always uses ANSI escaping (i.e. <code>`</code> for field names and <code>'</code> for strings).</p></li>
<li><p><code><a href="../reference/tbl_lazy.html">tbl_lazy()</a></code> now actually puts a <code><a href="https://dplyr.tidyverse.org/reference/src.html">dbplyr::src</a></code> in the <code>$src</code> field. This shouldn’t affect any downstream code unless you were previously working around this weird difference between <code>tbl_lazy</code> and <code>tbl_sql</code> classes. It also includes the <code>src</code> class in its class, and when printed, shows the generated SQL (<a href='https://github.com/tidyverse/dbplyr/issues/111'>#111</a>).</p></li>
</ul>
</div>
</div>
<div id="database-specific-improvements" class="section level2">
<h2 class="hasAnchor">
<a href="#database-specific-improvements" class="anchor"></a>Database specific improvements</h2>
<ul>
<li>
<p>MySQL/MariaDB</p>
<ul>
<li><p>Translations also applied to connections via the odbc package (<a href='https://github.com/colearendt'>@colearendt</a>, <a href='https://github.com/tidyverse/dbplyr/issues/238'>#238</a>)</p></li>
<li><p>Basic support for regular expressions via <code>str_detect()</code> and<br><code>str_replace_all()</code> (<a href='https://github.com/colearendt'>@colearendt</a>, <a href='https://github.com/tidyverse/dbplyr/issues/168'>#168</a>).</p></li>
<li><p>Improved translation for <code><a href="https://rdrr.io/r/base/logical.html">as.logical(x)</a></code> to <code>IF(x, TRUE, FALSE)</code>.</p></li>
</ul>
</li>
<li>
<p>Oracle</p>
<ul>
<li>New custom translation for <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> and <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code> (<a href='https://github.com/cderv'>@cderv</a>, <a href='https://github.com/tidyverse/dbplyr/issues/221'>#221</a>)</li>
</ul>
</li>
<li>
<p>Postgres</p>
<ul>
<li>Basic support for regular expressions via <code>str_detect()</code> and<br><code>str_replace_all()</code> (<a href='https://github.com/colearendt'>@colearendt</a>, <a href='https://github.com/tidyverse/dbplyr/issues/168'>#168</a>).</li>
</ul>
</li>
<li>
<p>SQLite</p>
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/explain.html">explain()</a></code> translation now generates <code>EXPLAIN QUERY PLAN</code> which generates a higher-level, more human friendly explanation.</li>
</ul>
</li>
<li>
<p>SQL server</p>
<ul>
<li><p>Improved translation for <code><a href="https://rdrr.io/r/base/logical.html">as.logical(x)</a></code> to <code>CAST(x as BIT)</code> (<a href='https://github.com/tidyverse/dbplyr/issues/250'>#250</a>).</p></li>
<li><p>Translates <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code>, <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code>, and <code>str_c()</code> to <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code>.</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/copy_to.html">copy_to()</a></code> method applies temporary table name transformation earlier so that you can now overwrite temporary tables (<a href='https://github.com/tidyverse/dbplyr/issues/258'>#258</a>).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_write_table()</a></code> method uses correct argument name for passing along field types (<a href='https://github.com/tidyverse/dbplyr/issues/251'>#251</a>).</p></li>
</ul>
</li>
</ul>
</div>
<div id="minor-improvements-and-bug-fixes" class="section level2">
<h2 class="hasAnchor">
<a href="#minor-improvements-and-bug-fixes" class="anchor"></a>Minor improvements and bug fixes</h2>
<ul>
<li><p>Aggregation functions only warn once per session about the use of <code>na.rm = TRUE</code> (<a href='https://github.com/tidyverse/dbplyr/issues/216'>#216</a>).</p></li>
<li><p>table names generated by <code>random_table_name()</code> have the prefix “dbplyr_”, which makes it easier to find them programmatically (<a href='https://github.com/mattle24'>@mattle24</a>, <a href='https://github.com/tidyverse/dbplyr/issues/111'>#111</a>)</p></li>
<li><p>Functions that are only available in a windowed (<code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>) query now throw an error when called in a aggregate (<code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code>) query (<a href='https://github.com/tidyverse/dbplyr/issues/129'>#129</a>)</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code> understands the <code>.by_group</code> argument, making it possible sort by groups if desired. The default is <code>FALSE</code> (<a href='https://github.com/tidyverse/dbplyr/issues/115'>#115</a>)</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct()</a></code> now handles computed variables like <code><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct(df, y = x + y)</a></code> (<a href='https://github.com/tidyverse/dbplyr/issues/154'>#154</a>).</p></li>
<li><p><code><a href="../reference/escape.html">escape()</a></code>, <code><a href="../reference/sql_expr.html">sql_expr()</a></code> and <code><a href="../reference/build_sql.html">build_sql()</a></code> no longer accept <code>con = NULL</code> as a shortcut for <code>con = simulate_dbi()</code>. This made it too easy to forget to pass <code>con</code> along, introducing extremely subtle escaping bugs. <code><a href="../reference/win_over.html">win_over()</a></code> gains a <code>con</code> argument for the same reason.</p></li>
<li><p>New <code><a href="../reference/escape.html">escape_ansi()</a></code> always uses ANSI SQL 92 standard escaping (for use in examples and documentation).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate(df, x = NULL)</a></code> drops <code>x</code> from the output, just like when working with local data frames (<a href='https://github.com/tidyverse/dbplyr/issues/194'>#194</a>).</p></li>
<li><p><code><a href="../reference/partial_eval.html">partial_eval()</a></code> processes inlined functions (including rlang lambda functions). This makes dbplyr work with more forms of scoped verbs like <code>df %&gt;% summarise_all(~ mean(.))</code>, <code>df %&gt;% summarise_all(list(mean))</code> (<a href='https://github.com/tidyverse/dbplyr/issues/134'>#134</a>).</p></li>
<li><p><code><a href="../reference/sql_substr.html">sql_aggregate()</a></code> now takes an optional argument <code>f_r</code> for passing to <code>check_na_rm()</code>. This allows the warning to show the R function name rather than the SQL function name (<a href='https://github.com/sverchkov'>@sverchkov</a>, <a href='https://github.com/tidyverse/dbplyr/issues/153'>#153</a>).</p></li>
<li><p><code><a href="../reference/sql_substr.html">sql_infix()</a></code> gains a <code>pad</code> argument for the rare operator that doesn’t need to be surrounded by spaces.</p></li>
<li><p><code><a href="../reference/sql_substr.html">sql_prefix()</a></code> no longer turns SQL functions into uppercase, allowing for correct translation of case-sensitive SQL functions (<a href='https://github.com/tidyverse/dbplyr/issues/181'>#181</a>, <a href='https://github.com/mtoto'>@mtoto</a>).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> gives a clear error message if you refer to a variable created in that same <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> (<a href='https://github.com/tidyverse/dbplyr/issues/114'>#114</a>).</p></li>
<li><p>New <code><a href="../reference/sql_expr.html">sql_call2()</a></code> which is to <code><a href="https://rlang.r-lib.org/reference/call2.html">rlang::call2()</a></code> as <code><a href="../reference/sql_expr.html">sql_expr()</a></code> is to <code><a href="https://rlang.r-lib.org/reference/nse-defuse.html">rlang::expr()</a></code>.</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/explain.html">show_query()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/explain.html">explain()</a></code> use <code><a href="https://rdrr.io/r/base/cat.html">cat()</a></code> rather than message.</p></li>
<li><p><code><a href="https://rdrr.io/pkg/generics/man/setops.html">union()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/setops.html">union_all()</a></code>, <code><a href="https://rdrr.io/pkg/generics/man/setops.html">setdiff()</a></code> and <code><a href="https://rdrr.io/pkg/generics/man/setops.html">intersect()</a></code> do a better job of matching columns across backends (<a href='https://github.com/tidyverse/dbplyr/issues/183'>#183</a>).</p></li>
</ul>
</div>
</div>
    <div id="dbplyr-130" class="section level1">
<h1 class="page-header" data-toc-text="1.3.0">
<a href="#dbplyr-130" class="anchor"></a>dbplyr 1.3.0<small> 2019-01-09 </small>
</h1>
<ul>
<li>Now supports for dplyr 0.8.0 (<a href='https://github.com/tidyverse/dbplyr/issues/190'>#190</a>) and R 3.1.0</li>
</ul>
<div id="api-changes" class="section level2">
<h2 class="hasAnchor">
<a href="#api-changes" class="anchor"></a>API changes</h2>
<ul>
<li><p>Calls of the form <code>dplyr::foo()</code> are now evaluated in the database, rather than locally (<a href='https://github.com/tidyverse/dbplyr/issues/197'>#197</a>).</p></li>
<li><p><code>vars</code> argument to <code><a href="../reference/tbl_sql.html">tbl_sql()</a></code> has been formally deprecated; it hasn’t actually done anything for a while (<a href='https://github.com/tidyverse/dbplyr/issues/3254'>#3254</a>).</p></li>
<li><p><code>src</code> and <code>tbl</code> objects now include a class generated from the class of the underlying connection object. This makes it possible for dplyr backends to implement different behaviour at the dplyr level, when needed. (<a href='https://github.com/tidyverse/dbplyr/issues/2293'>#2293</a>)</p></li>
</ul>
</div>
<div id="sql-translation" class="section level2">
<h2 class="hasAnchor">
<a href="#sql-translation" class="anchor"></a>SQL translation</h2>
<ul>
<li><p><code>x %in% y</code> is now translated to <code>FALSE</code> if <code>y</code> is empty (<a href='https://github.com/mgirlich'>@mgirlich</a>, <a href='https://github.com/tidyverse/dbplyr/issues/160'>#160</a>).</p></li>
<li><p>New <code>as.integer64(x)</code> translation to <code>CAST(x AS BIGINT)</code> (<a href='https://github.com/tidyverse/dbplyr/issues/3305'>#3305</a>)</p></li>
<li><p><code>case_when</code> now translates with a ELSE clause if a formula of the form <code>TRUE~&lt;RHS&gt;</code> is provided . (<a href='https://github.com/cderv'>@cderv</a>, <a href='https://github.com/tidyverse/dbplyr/issues/112'>#112</a>)</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/cumall.html">cummean()</a></code> now generates <code>AVG()</code> not <code>MEAN()</code> (<a href='https://github.com/tidyverse/dbplyr/issues/157'>#157</a>)</p></li>
<li><p><code>str_detect()</code> now uses correct parameter order (<a href='https://github.com/tidyverse/dbplyr/issues/3397'>#3397</a>)</p></li>
<li>
<p>MS SQL</p>
<ul>
<li>Cumulative summary functions now work (<a href='https://github.com/tidyverse/dbplyr/issues/157'>#157</a>)</li>
<li>
<code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> uses <code>CASE WHEN</code> instead of <code>IIF</code>; this allows more complex operations, such as <code><a href="https://rdrr.io/r/base/match.html">%in%</a></code>, to work properly (<a href='https://github.com/tidyverse/dbplyr/issues/93'>#93</a>)</li>
</ul>
</li>
<li>
<p>Oracle</p>
<ul>
<li>Custom <code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_drop_table()</a></code> now only drops tables if they exist (<a href='https://github.com/tidyverse/dbplyr/issues/3306'>#3306</a>)</li>
<li>Custom <code><a href="https://rdrr.io/pkg/generics/man/setops.html">setdiff()</a></code> translation (<a href='https://github.com/tidyverse/dbplyr/issues/3493'>#3493</a>)</li>
<li>Custom <code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_explain()</a></code> translation (<a href='https://github.com/tidyverse/dbplyr/issues/3471'>#3471</a>)</li>
</ul>
</li>
<li>
<p>SQLite</p>
<ul>
<li>Correct translation for <code><a href="https://rdrr.io/r/base/numeric.html">as.numeric()</a></code>/<code><a href="https://rdrr.io/r/base/double.html">as.double()</a></code> (<a href='https://github.com/chris-park'>@chris-park</a>, <a href='https://github.com/tidyverse/dbplyr/issues/171'>#171</a>).</li>
</ul>
</li>
<li>
<p>Redshift</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/substr.html">substr()</a></code> translation improved (<a href='https://github.com/tidyverse/dbplyr/issues/3339'>#3339</a>)</li>
</ul>
</li>
</ul>
</div>
<div id="minor-improvements-and-bug-fixes-1" class="section level2">
<h2 class="hasAnchor">
<a href="#minor-improvements-and-bug-fixes-1" class="anchor"></a>Minor improvements and bug fixes</h2>
<ul>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/copy_to.html">copy_to()</a></code> will only remove existing table when <code>overwrite = TRUE</code> and the table already exists, eliminating a confusing “NOTICE” from PostgreSQL (<a href='https://github.com/tidyverse/dbplyr/issues/3197'>#3197</a>).</p></li>
<li><p><code><a href="../reference/partial_eval.html">partial_eval()</a></code> handles unevaluated formulas (<a href='https://github.com/tidyverse/dbplyr/issues/184'>#184</a>).</p></li>
<li><p><code>pull.tbl_sql()</code> now extracts correctly from grouped tables (<a href='https://github.com/tidyverse/dbplyr/issues/3562'>#3562</a>).</p></li>
<li><p><code>sql_render.op()</code> now correctly forwards the <code>con</code> argument (<a href='https://github.com/kevinykuo'>@kevinykuo</a>, <a href='https://github.com/tidyverse/dbplyr/issues/73'>#73</a>).</p></li>
</ul>
</div>
</div>
    <div id="dbplyr-122" class="section level1">
<h1 class="page-header" data-toc-text="1.2.2">
<a href="#dbplyr-122" class="anchor"></a>dbplyr 1.2.2<small> 2018-07-25 </small>
</h1>
<ul>
<li>R CMD check fixes</li>
</ul>
</div>
    <div id="dbplyr-121" class="section level1">
<h1 class="page-header" data-toc-text="1.2.1">
<a href="#dbplyr-121" class="anchor"></a>dbplyr 1.2.1<small> 2018-02-19 </small>
</h1>
<ul>
<li>Forward compatibility fixes for rlang 0.2.0</li>
</ul>
</div>
    <div id="dbplyr-120" class="section level1">
<h1 class="page-header" data-toc-text="1.2.0">
<a href="#dbplyr-120" class="anchor"></a>dbplyr 1.2.0<small> 2018-01-03 </small>
</h1>
<div id="new-top-level-translations" class="section level2">
<h2 class="hasAnchor">
<a href="#new-top-level-translations" class="anchor"></a>New top-level translations</h2>
<ul>
<li>
<p>New translations for</p>
<ul>
<li>MS Access (<a href='https://github.com/tidyverse/dbplyr/issues/2946'>#2946</a>) (<a href='https://github.com/DavisVaughan'>@DavisVaughan</a>)</li>
<li>Oracle, via odbc or ROracle (<a href='https://github.com/tidyverse/dbplyr/issues/2928'>#2928</a>, <a href='https://github.com/tidyverse/dbplyr/issues/2732'>#2732</a>, <a href='https://github.com/edgararuiz'>@edgararuiz</a>)</li>
<li>Teradata.</li>
<li>Redshift.</li>
</ul>
</li>
<li><p>dbplyr now supplies appropriate translations for the RMariaDB and RPostgres packages (<a href='https://github.com/tidyverse/dbplyr/issues/3154'>#3154</a>). We generally recommend using these packages in favour of the older RMySQL and RPostgreSQL packages as they are fully DBI compliant and tested with DBItest.</p></li>
</ul>
</div>
<div id="new-features-1" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features-1" class="anchor"></a>New features</h2>
<ul>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/copy_to.html">copy_to()</a></code> can now “copy” tbl_sql in the same src, providing another way to cache a query into a temporary table (<a href='https://github.com/tidyverse/dbplyr/issues/3064'>#3064</a>). You can also <code>copy_to</code> tbl_sqls from another source, and <code><a href="https://dplyr.tidyverse.org/reference/copy_to.html">copy_to()</a></code> will automatically collect then copy.</p></li>
<li><p>Initial support for stringr functions: <code>str_length()</code>, <code>str_to_upper()</code>, <code>str_to_lower()</code>, <code>str_replace_all()</code>, <code>str_detect()</code>, <code>str_trim()</code>. Regular expression support varies from database to database, but most simple regular expressions should be ok.</p></li>
</ul>
</div>
<div id="tools-for-developers" class="section level2">
<h2 class="hasAnchor">
<a href="#tools-for-developers" class="anchor"></a>Tools for developers</h2>
<ul>
<li><p><code><a href="../reference/db_compute.html">db_compute()</a></code> gains an <code>analyze</code> argument to match <code><a href="../reference/db_compute.html">db_copy_to()</a></code>.</p></li>
<li><p>New <code><a href="../reference/remote_name.html">remote_name()</a></code>, <code><a href="../reference/remote_name.html">remote_con()</a></code>, <code><a href="../reference/remote_name.html">remote_src()</a></code>, <code><a href="../reference/remote_name.html">remote_query()</a></code> and <code><a href="../reference/remote_name.html">remote_query_plan()</a></code> provide a standard API for get metadata about a remote tbl (<a href='https://github.com/tidyverse/dbplyr/issues/3130'>#3130</a>, <a href='https://github.com/tidyverse/dbplyr/issues/2923'>#2923</a>, <a href='https://github.com/tidyverse/dbplyr/issues/2824'>#2824</a>).</p></li>
<li><p>New <code><a href="../reference/sql_expr.html">sql_expr()</a></code> is a more convenient building block for low-level SQL translation (<a href='https://github.com/tidyverse/dbplyr/issues/3169'>#3169</a>).</p></li>
<li><p>New <code><a href="../reference/sql_substr.html">sql_aggregate()</a></code> and <code><a href="../reference/win_over.html">win_aggregate()</a></code> for generating SQL and windowed SQL functions for aggregates. These take one argument, <code>x</code>, and warn if <code>na.rm</code> is not <code>TRUE</code> (<a href='https://github.com/tidyverse/dbplyr/issues/3155'>#3155</a>). <code><a href="../reference/win_over.html">win_recycled()</a></code> is equivalent to <code><a href="../reference/win_over.html">win_aggregate()</a></code> and has been soft-deprecated.</p></li>
<li><p><code>db_write_table</code> now needs to return the table name</p></li>
</ul>
</div>
<div id="minor-improvements-and-bug-fixes-2" class="section level2">
<h2 class="hasAnchor">
<a href="#minor-improvements-and-bug-fixes-2" class="anchor"></a>Minor improvements and bug fixes</h2>
<ul>
<li><p>Multiple <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> calls in a row now collapse to a single call. This avoids a printing problem with MS SQL (<a href='https://github.com/tidyverse/dbplyr/issues/3084'>#3084</a>).</p></li>
<li><p><code><a href="../reference/escape.html">escape()</a></code> now works with integer64 values from the bit64 package (<a href='https://github.com/tidyverse/dbplyr/issues/3230'>#3230</a>)</p></li>
<li><p><code>if</code>, <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code>, and <code><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else()</a></code> now correctly scope the false condition so that it only applies to non-NULL conditions (<a href='https://github.com/tidyverse/dbplyr/issues/3157'>#3157</a>)</p></li>
<li><p><code><a href="../reference/ident.html">ident()</a></code> and <code><a href="../reference/ident_q.html">ident_q()</a></code> handle 0-length inputs better, and should be easier to use with S3 (<a href='https://github.com/tidyverse/dbplyr/issues/3212'>#3212</a>)</p></li>
<li><p><code><a href="../reference/in_schema.html">in_schema()</a></code> should now work in more places, particularly in <code><a href="https://dplyr.tidyverse.org/reference/copy_to.html">copy_to()</a></code> (<a href='https://github.com/tidyverse/dbplyr/issues/3013'>#3013</a>, <a href='https://github.com/baileych'>@baileych</a>)</p></li>
<li><p>SQL generation for joins no longer gets stuck in a endless loop if you request an empty suffix (<a href='https://github.com/tidyverse/dbplyr/issues/3220'>#3220</a>).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> has better logic for splitting a single mutate into multiple subqueries (<a href='https://github.com/tidyverse/dbplyr/issues/3095'>#3095</a>).</p></li>
<li><p>Improved <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code> and <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code> support in MySQL, PostgreSQL (<a href='https://github.com/tidyverse/dbplyr/issues/3168'>#3168</a>), and RSQLite (<a href='https://github.com/tidyverse/dbplyr/issues/3176'>#3176</a>). MySQL and PostgreSQL gain support for <code>str_flatten()</code> which behaves like <code><a href="https://rdrr.io/r/base/paste.html">paste(x, collapse = "-")</a></code> (but for technical reasons can’t be implemented as a straightforward translation of <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code>).</p></li>
<li><p><code>same_src.tbl_sql()</code> now performs correct comparison instead of always returning <code>TRUE</code>. This means that <code>copy = TRUE</code> once again allows you to perform cross-database joins (<a href='https://github.com/tidyverse/dbplyr/issues/3002'>#3002</a>).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> queries no longer alias column names unnecessarily (<a href='https://github.com/tidyverse/dbplyr/issues/2968'>#2968</a>, <a href='https://github.com/DavisVaughan'>@DavisVaughan</a>).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code> are now powered by tidyselect, fixing a few renaming bugs (<a href='https://github.com/tidyverse/dbplyr/issues/3132'>#3132</a>, <a href='https://github.com/tidyverse/dbplyr/issues/2943'>#2943</a>, <a href='https://github.com/tidyverse/dbplyr/issues/2860'>#2860</a>).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> once again performs partial evaluation before database submission (<a href='https://github.com/tidyverse/dbplyr/issues/3148'>#3148</a>).</p></li>
<li><p><code>test_src()</code> makes it easier to access a single test source.</p></li>
</ul>
</div>
<div id="database-specific-improvements-1" class="section level2">
<h2 class="hasAnchor">
<a href="#database-specific-improvements-1" class="anchor"></a>Database specific improvements</h2>
<ul>
<li>
<p>MS SQL</p>
<ul>
<li><p>Better support for temporary tables (<a href='https://github.com/Hong-Revo'>@Hong-Revo</a>)</p></li>
<li><p>Different translations for filter/mutate contexts for: <code>NULL</code> evaluation (<code><a href="https://rdrr.io/r/base/NA.html">is.na()</a></code>, <code><a href="https://rdrr.io/r/base/NULL.html">is.null()</a></code>), logical operators (<code><a href="https://rdrr.io/r/base/Logic.html">!</a></code>, <code><a href="https://rdrr.io/r/base/Logic.html">&amp;</a></code>, <code><a href="https://rdrr.io/r/base/Logic.html">&amp;&amp;</a></code>, <code><a href="https://rdrr.io/r/base/Logic.html">|</a></code>, <code><a href="https://rdrr.io/r/base/Logic.html">||</a></code>), and comparison operators (<code><a href="https://rdrr.io/r/base/Comparison.html">==</a></code>, <code><a href="https://rdrr.io/r/base/Comparison.html">!=</a></code>, <code><a href="https://rdrr.io/r/base/Comparison.html">&lt;</a></code>, <code><a href="https://rdrr.io/r/base/Comparison.html">&gt;</a></code>, <code><a href="https://rdrr.io/r/base/Comparison.html">&gt;=</a></code>, <code><a href="https://rdrr.io/r/base/Comparison.html">&lt;=</a></code>)</p></li>
</ul>
</li>
<li><p>MySQL: <code><a href="https://dplyr.tidyverse.org/reference/copy_to.html">copy_to()</a></code> (via <code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_write_table()</a></code>) correctly translates logical variables to integers (<a href='https://github.com/tidyverse/dbplyr/issues/3151'>#3151</a>).</p></li>
<li><p>odbc: improved <code><a href="https://dplyr.tidyverse.org/reference/context.html">n()</a></code> translation in windowed context.</p></li>
<li><p>SQLite: improved <code>na_if</code> translation (<a href='https://github.com/cwarden'>@cwarden</a>)</p></li>
<li><p>PostgreSQL: translation for <code><a href="https://rdrr.io/r/base/grep.html">grepl()</a></code> added (<a href='https://github.com/zozlak'>@zozlak</a>)</p></li>
<li><p>Oracle: changed VARVHAR to VARCHAR2 datatype (<a href='https://github.com/washcycle'>@washcycle</a>, <a href='https://github.com/tidyverse/dbplyr/issues/66'>#66</a>)</p></li>
</ul>
</div>
</div>
    <div id="dbplyr-110" class="section level1">
<h1 class="page-header" data-toc-text="1.1.0">
<a href="#dbplyr-110" class="anchor"></a>dbplyr 1.1.0<small> 2017-06-27 </small>
</h1>
<div id="new-features-2" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features-2" class="anchor"></a>New features</h2>
<ul>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join()</a></code> over non-overlapping columns <code>by = character()</code> translated to <code>CROSS JOIN</code> (<a href='https://github.com/tidyverse/dbplyr/issues/2924'>#2924</a>).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> now translates to SQL “CASE WHEN” (<a href='https://github.com/tidyverse/dbplyr/issues/2894'>#2894</a>)</p></li>
<li><p><code>x %in% c(1)</code> now generates the same SQL as <code>x %in% 1</code> (<a href='https://github.com/tidyverse/dbplyr/issues/2898'>#2898</a>).</p></li>
<li><p>New <code><a href="../reference/window_order.html">window_order()</a></code> and <code><a href="../reference/window_order.html">window_frame()</a></code> give you finer control over the window functions that dplyr creates (<a href='https://github.com/tidyverse/dbplyr/issues/2874'>#2874</a>, <a href='https://github.com/tidyverse/dbplyr/issues/2593'>#2593</a>).</p></li>
<li><p>Added SQL translations for Oracle (<a href='https://github.com/edgararuiz'>@edgararuiz</a>).</p></li>
</ul>
</div>
<div id="minor-improvements-and-bug-fixes-3" class="section level2">
<h2 class="hasAnchor">
<a href="#minor-improvements-and-bug-fixes-3" class="anchor"></a>Minor improvements and bug fixes</h2>
<ul>
<li><p><code>x %in% c(1)</code> now generates the same SQL as <code>x %in% 1</code> (<a href='https://github.com/tidyverse/dbplyr/issues/2898'>#2898</a>).</p></li>
<li><p><code><a href="https://rdrr.io/r/utils/head.html">head(tbl, 0)</a></code> is now supported (<a href='https://github.com/tidyverse/dbplyr/issues/2863'>#2863</a>).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>ing zero columns gives a more information error message (<a href='https://github.com/tidyverse/dbplyr/issues/2863'>#2863</a>).</p></li>
<li><p>Variables created in a join are now disambiguated against other variables in the same table, not just variables in the other table (<a href='https://github.com/tidyverse/dbplyr/issues/2823'>#2823</a>).</p></li>
<li><p>PostgreSQL gains a better translation for <code><a href="https://rdrr.io/r/base/Round.html">round()</a></code> (<a href='https://github.com/tidyverse/dbplyr/issues/60'>#60</a>).</p></li>
<li><p>Added custom <code>db_analyze_table()</code> for MS SQL, Oracle, Hive and Impala (<a href='https://github.com/edgararuiz'>@edgararuiz</a>)</p></li>
<li><p>Added support for <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code> for aggregate and window functions (<a href='https://github.com/tidyverse/dbplyr/issues/2887'>#2887</a>) (<a href='https://github.com/edgararuiz'>@edgararuiz</a>)</p></li>
<li><p>You can now use the magrittr pipe within expressions, e.g. <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate(mtcars, cyl %&gt;% as.character())</a></code>.</p></li>
<li><p>If a translation was supplied for a summarise function, but not for the equivalent windowed variant, the expression would be translated to <code>NULL</code> with a warning. Now <code><a href="../reference/sql_substr.html">sql_variant()</a></code> checks that all aggregate functions have matching window functions so that correct translations or clean errors will be generated (<a href='https://github.com/tidyverse/dbplyr/issues/2887'>#2887</a>)</p></li>
</ul>
</div>
</div>
    <div id="dbplyr-100" class="section level1">
<h1 class="page-header" data-toc-text="1.0.0">
<a href="#dbplyr-100" class="anchor"></a>dbplyr 1.0.0<small> 2017-06-09 </small>
</h1>
<div id="new-features-3" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features-3" class="anchor"></a>New features</h2>
<ul>
<li>
<p><code><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/copy_to.html">copy_to()</a></code> now work directly with DBI connections (<a href='https://github.com/tidyverse/dbplyr/issues/2423'>#2423</a>, <a href='https://github.com/tidyverse/dbplyr/issues/2576'>#2576</a>), so there is no longer a need to generate a dplyr src.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://dplyr.tidyverse.org">dplyr</a></span>)

<span class="kw">con</span> <span class="op">&lt;-</span> <span class="kw">DBI</span>::<span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html">dbConnect</a></span>(<span class="kw">RSQLite</span>::<span class="fu"><a href="https://rsqlite.r-dbi.org/reference/SQLite.html">SQLite</a></span>(), <span class="st">":memory:"</span>)
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/copy_to.html">copy_to</a></span>(<span class="kw">con</span>, <span class="kw">mtcars</span>)

<span class="kw">mtcars2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span>(<span class="kw">con</span>, <span class="st">"mtcars"</span>)
<span class="kw">mtcars2</span>
</pre></div>
</li>
<li><p><code><a href="https://tibble.tidyverse.org/reference/glimpse.html">glimpse()</a></code> now works with remote tables (<a href='https://github.com/tidyverse/dbplyr/issues/2665'>#2665</a>)</p></li>
<li><p>dplyr has gained a basic SQL optimiser, which collapses certain nested SELECT queries into a single query (<a href='https://github.com/tidyverse/dbplyr/issues/1979'>#1979</a>). This will improve query execution performance for databases with less sophisticated query optimisers, and fixes certain problems with ordering and limits in subqueries (<a href='https://github.com/tidyverse/dbplyr/issues/1979'>#1979</a>). A big thanks goes to <a href='https://github.com/hhoeflin'>@hhoeflin</a> for figuring out this optimisation.</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/compute.html">compute()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/compute.html">collapse()</a></code> now preserve the “ordering” of rows. This only affects the computation of window functions, as the rest of SQL does not care about row order (<a href='https://github.com/tidyverse/dbplyr/issues/2281'>#2281</a>).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/copy_to.html">copy_to()</a></code> gains an <code>overwrite</code> argument which allows you to overwrite an existing table. Use with care! (<a href='https://github.com/tidyverse/dbplyr/issues/2296'>#2296</a>)</p></li>
<li><p>New <code><a href="../reference/in_schema.html">in_schema()</a></code> function makes it easy to refer to tables in schema: <code><a href="../reference/in_schema.html">in_schema("my_schema_name", "my_table_name")</a></code>.</p></li>
</ul>
</div>
<div id="deprecated-and-defunct" class="section level2">
<h2 class="hasAnchor">
<a href="#deprecated-and-defunct" class="anchor"></a>Deprecated and defunct</h2>
<ul>
<li>
<code>query()</code> is no longer exported. It hasn’t been useful for a while so this shouldn’t break any code.</li>
</ul>
</div>
<div id="verb-level-sql-generation" class="section level2">
<h2 class="hasAnchor">
<a href="#verb-level-sql-generation" class="anchor"></a>Verb-level SQL generation</h2>
<ul>
<li><p>Partial evaluation occurs immediately when you execute a verb (like <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> or <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>) rather than happening when the query is executed (<a href='https://github.com/tidyverse/dbplyr/issues/2370'>#2370</a>).</p></li>
<li><p><code>mutate.tbl_sql()</code> will now generate as many subqueries as necessary so that you can refer to variables that you just created (like in mutate with regular dataframes) (<a href='https://github.com/tidyverse/dbplyr/issues/2481'>#2481</a>, <a href='https://github.com/tidyverse/dbplyr/issues/2483'>#2483</a>).</p></li>
<li>
<p>SQL joins have been improved:</p>
<ul>
<li><p>SQL joins always use the <code>ON ...</code> syntax, avoiding <code>USING ...</code> even for natural joins. Improved handling of tables with columns of the same name (<a href='https://github.com/tidyverse/dbplyr/issues/1997'>#1997</a>, <a href='https://github.com/javierluraschi'>@javierluraschi</a>). They now generate SQL more similar to what you’d write by hand, eliminating a layer or two of subqueries (<a href='https://github.com/tidyverse/dbplyr/issues/2333'>#2333</a>)</p></li>
<li><p>[API] They now follow the same rules for including duplicated key variables that the data frame methods do, namely that key variables are only kept from <code>x</code>, and never from <code>y</code> (<a href='https://github.com/tidyverse/dbplyr/issues/2410'>#2410</a>)</p></li>
<li><p>[API] The <code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">sql_join()</a></code> generic now gains a <code>vars</code> argument which lists the variables taken from the left and right sides of the join. If you have a custom <code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">sql_join()</a></code> method, you’ll need to update how your code generates joins, following the template in <code>sql_join.generic()</code>.</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join()</a></code> throws a clear error when you attempt to use it with a MySQL backend (<a href='https://github.com/tidyverse/dbplyr/issues/2045'>#2045</a>)</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">right_join()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join()</a></code> now return results consistent with local data frame sources when there are records in the right table with no match in the left table. <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">right_join()</a></code> returns values of <code>by</code> columns from the right table. <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join()</a></code> returns coalesced values of <code>by</code> columns from the left and right tables (<a href='https://github.com/tidyverse/dbplyr/issues/2578'>#2578</a>, <a href='https://github.com/ianmcook'>@ianmcook</a>)</p></li>
</ul>
</li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> can now perform an inline mutate for database backends (<a href='https://github.com/tidyverse/dbplyr/issues/2422'>#2422</a>).</p></li>
<li>
<p>The SQL generation set operations (<code><a href="https://rdrr.io/pkg/generics/man/setops.html">intersect()</a></code>, <code><a href="https://rdrr.io/pkg/generics/man/setops.html">setdiff()</a></code>, <code><a href="https://rdrr.io/pkg/generics/man/setops.html">union()</a></code>, and <code><a href="https://dplyr.tidyverse.org/reference/setops.html">union_all()</a></code>) have been considerably improved.</p>
<p>By default, the component SELECT are surrounded with parentheses, except on SQLite. The SQLite backend will now throw an error if you attempt a set operation on a query that contains a LIMIT, as that is not supported in SQLite (<a href='https://github.com/tidyverse/dbplyr/issues/2270'>#2270</a>).</p>
<p>All set operations match column names across inputs, filling in non-matching variables with NULL (<a href='https://github.com/tidyverse/dbplyr/issues/2556'>#2556</a>).</p>
</li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> now combine correctly (<a href='https://github.com/tidyverse/dbplyr/issues/1962'>#1962</a>)</p></li>
<li><p><code><a href="../reference/tbl_lazy.html">tbl_lazy()</a></code> and <code>lazy_tbl()</code> have been exported. These help you test generated SQL with out an active database connection.</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup()</a></code> correctly resets grouping variables (<a href='https://github.com/tidyverse/dbplyr/issues/2704'>#2704</a>).</p></li>
</ul>
</div>
<div id="vector-level-sql-generation" class="section level2">
<h2 class="hasAnchor">
<a href="#vector-level-sql-generation" class="anchor"></a>Vector-level SQL generation</h2>
<ul>
<li><p>New <code><a href="../reference/sql.html">as.sql()</a></code> safely coerces an input to SQL.</p></li>
<li><p>More translators for <code><a href="https://rdrr.io/r/base/character.html">as.character()</a></code>, <code><a href="https://rdrr.io/r/base/integer.html">as.integer()</a></code> and <code><a href="https://rdrr.io/r/base/double.html">as.double()</a></code> (<a href='https://github.com/tidyverse/dbplyr/issues/2775'>#2775</a>).</p></li>
<li><p>New <code><a href="../reference/ident_q.html">ident_q()</a></code> makes it possible to specifier identifiers that do not need to be quoted.</p></li>
<li>
<p>Translation of inline scalars:</p>
<ul>
<li><p>Logical values are now translated differently depending on the backend. The default is to use “true” and “false” which is the SQL-99 standard, but not widely support. SQLite translates to “0” and “1” (<a href='https://github.com/tidyverse/dbplyr/issues/2052'>#2052</a>).</p></li>
<li><p><code>Inf</code> and <code>-Inf</code> are correctly escaped</p></li>
<li><p>Better test for whether or not a double is similar to an integer and hence needs a trailing 0.0 added (<a href='https://github.com/tidyverse/dbplyr/issues/2004'>#2004</a>).</p></li>
<li><p>Quoting defaults to <code>DBI::dbEscapeString()</code> and <code><a href="https://dbi.r-dbi.org/reference/dbQuoteIdentifier.html">DBI::dbQuoteIdentifier()</a></code> respectively.</p></li>
</ul>
</li>
<li><p><code><a href="https://rdrr.io/r/base/ns-dblcolon.html">::</a></code> and <code><a href="https://rdrr.io/r/base/ns-dblcolon.html">:::</a></code> are handled correctly (<a href='https://github.com/tidyverse/dbplyr/issues/2321'>#2321</a>)</p></li>
<li><p><code>x %in% 1</code> is now correctly translated to <code>x IN (1)</code> (<a href='https://github.com/tidyverse/dbplyr/issues/511'>#511</a>).</p></li>
<li><p><code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else()</a></code> use correct argument names in SQL translation (<a href='https://github.com/tidyverse/dbplyr/issues/2225'>#2225</a>).</p></li>
<li><p><code><a href="../reference/ident.html">ident()</a></code> now returns an object with class <code><a href="https://rdrr.io/r/base/c.html">c("ident", "character")</a></code>. It no longer contains “sql” to indicate that this is not already escaped.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/NA.html">is.na()</a></code> and <code><a href="https://rdrr.io/r/base/NULL.html">is.null()</a></code> gain extra parens in SQL translation to preserve correct precedence (<a href='https://github.com/tidyverse/dbplyr/issues/2302'>#2302</a>).</p></li>
<li><p>[API] <code><a href="https://rdrr.io/r/base/Log.html">log(x, b)</a></code> is now correctly translated to the SQL <code><a href="https://rdrr.io/r/base/Log.html">log(b, x)</a></code> (<a href='https://github.com/tidyverse/dbplyr/issues/2288'>#2288</a>). SQLite does not support the 2-argument log function so it is translated to <code>log(x) / log(b)</code>.</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/nth.html">nth(x, i)</a></code> is now correctly translated to <code>nth_value(x, i)</code>.</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct()</a></code> now accepts multiple variables (<a href='https://github.com/tidyverse/dbplyr/issues/2148'>#2148</a>).</p></li>
<li><p>[API] <code><a href="https://rdrr.io/r/base/substr.html">substr()</a></code> is now translated to SQL, correcting for the difference in the third argument. In R, it’s the position of the last character, in SQL it’s the length of the string (<a href='https://github.com/tidyverse/dbplyr/issues/2536'>#2536</a>).</p></li>
<li><p><code><a href="../reference/win_over.html">win_over()</a></code> escapes expression using current database rules.</p></li>
</ul>
</div>
<div id="backends" class="section level2">
<h2 class="hasAnchor">
<a href="#backends" class="anchor"></a>Backends</h2>
<ul>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/copy_to.html">copy_to()</a></code> now uses <code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_write_table()</a></code> instead of <code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_create_table()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_insert_into()</a></code>. <code>db_write_table.DBIConnection()</code> uses <code><a href="https://dbi.r-dbi.org/reference/dbWriteTable.html">dbWriteTable()</a></code>.</p></li>
<li><p>New <code><a href="../reference/db_compute.html">db_copy_to()</a></code>, <code><a href="../reference/db_compute.html">db_compute()</a></code> and <code><a href="../reference/db_compute.html">db_collect()</a></code> allow backends to override the entire database process behind <code><a href="https://dplyr.tidyverse.org/reference/copy_to.html">copy_to()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/compute.html">compute()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/compute.html">collect()</a></code>. <code><a href="../reference/db_compute.html">db_sql_render()</a></code> allow additional control over the SQL rendering process.</p></li>
<li><p>All generics whose behaviour can vary from database to database now provide a DBIConnection method. That means that you can easily scan the NAMESPACE to see the extension points.</p></li>
<li><p><code><a href="../reference/sql_escape_logical.html">sql_escape_logical()</a></code> allows you to control the translation of literal logicals (<a href='https://github.com/tidyverse/dbplyr/issues/2614'>#2614</a>).</p></li>
<li><p><code>src_desc()</code> has been replaced by <code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_desc()</a></code> and now dispatches on the connection, eliminating the last method that required dispatch on the class of the src.</p></li>
<li><p><code><a href="../reference/win_over.html">win_over()</a></code>, <code><a href="../reference/win_over.html">win_rank()</a></code>, <code><a href="../reference/win_over.html">win_recycled()</a></code>, <code><a href="../reference/win_over.html">win_cumulative()</a></code>, <code><a href="../reference/win_over.html">win_current_group()</a></code> and <code><a href="../reference/win_over.html">win_current_order()</a></code> are now exported. This should make it easier to provide customised SQL for window functions (<a href='https://github.com/tidyverse/dbplyr/issues/2051'>#2051</a>, <a href='https://github.com/tidyverse/dbplyr/issues/2126'>#2126</a>).</p></li>
<li><p>SQL translation for Microsoft SQL Server (<a href='https://github.com/edgararuiz'>@edgararuiz</a>)</p></li>
<li><p>SQL translation for Apache Hive (<a href='https://github.com/edgararuiz'>@edgararuiz</a>)</p></li>
<li><p>SQL translation for Apache Impala (<a href='https://github.com/edgararuiz'>@edgararuiz</a>)</p></li>
</ul>
</div>
<div id="minor-bug-fixes-and-improvements" class="section level2">
<h2 class="hasAnchor">
<a href="#minor-bug-fixes-and-improvements" class="anchor"></a>Minor bug fixes and improvements</h2>
<ul>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/compute.html">collect()</a></code> once again defaults to return all rows in the data (<a href='https://github.com/tidyverse/dbplyr/issues/1968'>#1968</a>). This makes it behave the same as <code><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame()</a></code> and <code><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble()</a></code>.</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/compute.html">collect()</a></code> only regroups by variables present in the data (<a href='https://github.com/tidyverse/dbplyr/issues/2156'>#2156</a>)</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/compute.html">collect()</a></code> will automatically LIMIT the result to the <code>n</code>, the number of rows requested. This will provide the query planner with more information that it may be able to use to improve execution time (<a href='https://github.com/tidyverse/dbplyr/issues/2083'>#2083</a>).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/common_by.html">common_by()</a></code> gets a better error message for unexpected inputs (<a href='https://github.com/tidyverse/dbplyr/issues/2091'>#2091</a>)</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/copy_to.html">copy_to()</a></code> no longer checks that the table doesn’t exist before creation, instead preferring to fall back on the database for error messages. This should reduce both false positives and false negative (<a href='https://github.com/tidyverse/dbplyr/issues/1470'>#1470</a>)</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/copy_to.html">copy_to()</a></code> now succeeds for MySQL if a character column contains <code>NA</code> (<a href='https://github.com/tidyverse/dbplyr/issues/1975'>#1975</a>, <a href='https://github.com/tidyverse/dbplyr/issues/2256'>#2256</a>, <a href='https://github.com/tidyverse/dbplyr/issues/2263'>#2263</a>, <a href='https://github.com/tidyverse/dbplyr/issues/2381'>#2381</a>, <a href='https://github.com/demorenoc'>@demorenoc</a>, <a href='https://github.com/eduardgrebe'>@eduardgrebe</a>).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/copy_to.html">copy_to()</a></code> now returns it’s output invisibly (since you’re often just calling for the side-effect).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct()</a></code> reports improved variable information for SQL backends. This means that it is more likely to work in the middle of a pipeline (<a href='https://github.com/tidyverse/dbplyr/issues/2359'>#2359</a>).</p></li>
<li><p>Ungrouped <code><a href="https://dplyr.tidyverse.org/reference/do.html">do()</a></code> on database backends now collects all data locally first (<a href='https://github.com/tidyverse/dbplyr/issues/2392'>#2392</a>).</p></li>
<li><p>Call <code><a href="https://dbi.r-dbi.org/reference/dbFetch.html">dbFetch()</a></code> instead of the deprecated <code><a href="https://dbi.r-dbi.org/reference/dbFetch.html">fetch()</a></code> (<a href='https://github.com/tidyverse/dbplyr/issues/2134'>#2134</a>). Use <code><a href="https://dbi.r-dbi.org/reference/dbExecute.html">DBI::dbExecute()</a></code> for non-query SQL commands (<a href='https://github.com/tidyverse/dbplyr/issues/1912'>#1912</a>)</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/explain.html">explain()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/explain.html">show_query()</a></code> now invisibly return the first argument, making them easier to use inside a pipeline.</p></li>
<li><p><code>print.tbl_sql()</code> displays ordering (<a href='https://github.com/tidyverse/dbplyr/issues/2287'>#2287</a>) and prints table name, if known.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/print.html">print(df, n = Inf)</a></code> and <code><a href="https://rdrr.io/r/utils/head.html">head(df, n = Inf)</a></code> now work with remote tables (<a href='https://github.com/tidyverse/dbplyr/issues/2580'>#2580</a>).</p></li>
<li><p><code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">db_desc()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/backend_dbplyr.html">sql_translate_env()</a></code> get defaults for DBIConnection.</p></li>
<li><p>Formatting now works by overriding the <code><a href="https://tibble.tidyverse.org/reference/tbl_sum.html">tbl_sum()</a></code> generic instead of <code><a href="https://rdrr.io/r/base/print.html">print()</a></code>. This means that the output is more consistent with tibble, and that <code><a href="https://rdrr.io/r/base/format.html">format()</a></code> is now supported also for SQL sources (tidyverse/dbplyr<a href='https://github.com/tidyverse/dbplyr/issues/14'>#14</a>).</p></li>
</ul>
</div>
<div id="lazy-ops" class="section level2">
<h2 class="hasAnchor">
<a href="#lazy-ops" class="anchor"></a>Lazy ops</h2>
<ul>
<li><p>[API] The signature of <code>op_base</code> has changed to <code><a href="../reference/lazy_ops.html">op_base(x, vars, class)</a></code></p></li>
<li>
<p>[API] <code><a href="../reference/translate_sql.html">translate_sql()</a></code> and <code><a href="../reference/partial_eval.html">partial_eval()</a></code> have been refined:</p>
<ul>
<li><p><code><a href="../reference/translate_sql.html">translate_sql()</a></code> no longer takes a vars argument; instead call <code><a href="../reference/partial_eval.html">partial_eval()</a></code> yourself.</p></li>
<li><p>Because it no longer needs the environment <code>translate_sql()_</code> now works with a list of dots, rather than a <code>lazy_dots</code>.</p></li>
<li><p><code><a href="../reference/partial_eval.html">partial_eval()</a></code> now takes a character vector of variable names rather than a tbl.</p></li>
<li><p>This leads to a simplification of the <code>op</code> data structure: dots is now a list of expressions rather than a <code>lazy_dots</code>.</p></li>
</ul>
</li>
<li><p>[API] <code><a href="../reference/lazy_ops.html">op_vars()</a></code> now returns a list of quoted expressions. This enables escaping to happen at the correct time (i.e. when the connection is known).</p></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>

</div>


      <footer>
      <div class="tidyverse">
  <p>dbplyr is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="https://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>
    Developed by <a href='http://hadley.nz'>Hadley Wickham</a>, Edgar Ruiz, <a href='https://www.rstudio.com'><img src='https://www.tidyverse.org/rstudio-logo.svg' alt='RStudio' height='24' /></a>.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
   </div>

  


  </body>
</html>


