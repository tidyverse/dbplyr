% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/build-sql.R
\name{glue_sql2}
\alias{glue_sql2}
\title{Build SQL strings with glue syntax}
\usage{
glue_sql2(.con, ..., .envir = parent.frame())
}
\arguments{
\item{.con}{A database connection.}

\item{...}{SQL fragments to interpolate. These are evaluated in \code{.envir} and
then combined according to their type markers.}

\item{.envir}{Environment to evaluate \code{...} in.}
}
\value{
An SQL string.
}
\description{
\code{glue_sql2()} is a SQL string builder that uses \code{\link[glue:glue]{glue::glue()}} syntax with
special type markers for safe SQL generation. It replaces the deprecated
\code{\link[=build_sql]{build_sql()}} function with a more explicit and type-safe approach.

Within the glue template, use type markers to specify how values should be
escaped and formatted:
\itemize{
\item \code{.sql} - An existing SQL string.
\item \code{.tbl} - A table identifier (e.g., \code{DBI::Id()}, string, or \code{in_schema()}).
\item \code{.from} - A subquery or table identifier.
\item \code{.id} - Database identifiers. Use \code{*} suffix for multiple identifiers,
which will not be wrapped.
\item \code{.kw} - An SQL keyword that will be syntax-highlighted.
\item \code{.val} - A value. Typically used when the function has a scalar argument
or a vector argument is that not vectorised with the primary input.
Use \code{*} suffix for multiple values, which will be wrapped in \verb{()}.
}
}
\examples{
con <- simulate_dbi()

tbl <- "my_table"
glue_sql2(con, "SELECT * FROM {.tbl tbl}")

# Values are properly escaped
name <- "Robert'); DROP TABLE students;--"
glue_sql2(con, "INSERT INTO students (name) VALUES ({.val name})")

# Multiple columns with collapse
cols <- ident(c("name", "age", "grade"))
glue_sql2(con, "SELECT {.id cols*} FROM students")
}
