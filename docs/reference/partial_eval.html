<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Partially evaluate an expression. — partial_eval • dbplyr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>

<!-- Bootstrap -->
<link href="../tidyverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- tidyverse -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">dbplyr</a>
        <small class="tidyverse">part of the <a href="http://tidyverse.org">tidyverse</a></small>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/dbplyr.html">Intro</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/sql-translation.html">SQL translation</a>
    </li>
    <li>
      <a href="../articles/new-backend.html">Creating new backends</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
        <li>
  <a href="https://github.com/tidyverse/dbplyr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Partially evaluate an expression.</h1>
    </div>

    
    <p>This function partially evaluates an expression, using information from
the tbl to determine whether names refer to local expressions
or remote variables. This simplifies SQL translation because expressions
don't need to carry around their environment - all revelant information
is incorporated into the expression.</p>
    

    <pre class="usage"><span class='fu'>partial_eval</span>(<span class='no'>call</span>, <span class='kw'>vars</span> <span class='kw'>=</span> <span class='fu'>character</span>(), <span class='kw'>env</span> <span class='kw'>=</span> <span class='fu'>caller_env</span>())</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>call</th>
      <td><p>an unevaluated expression, as produced by <code>quote()</code></p></td>
    </tr>
    <tr>
      <th>vars</th>
      <td><p>character vector of variable names.</p></td>
    </tr>
    <tr>
      <th>env</th>
      <td><p>environment in which to search for local values</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="symbol-substitution"><a class="anchor" href="#symbol-substitution"></a>Symbol substitution</h2>

    
    <p><code>partial_eval()</code> needs to guess if you're referring to a variable on the
server (remote), or in the current environment (local). It's not possible to
do this 100<!-- % perfectly. \code{partial_eval()} uses the following heuristic: --></p><ul>
<li><p>If the tbl variables are known, and the symbol matches a tbl
variable, then remote.</p></li>
<li><p>If the symbol is defined locally, local.</p></li>
<li><p>Otherwise, remote.</p></li>
</ul>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>vars</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"year"</span>, <span class='st'>"id"</span>)
<span class='fu'>partial_eval</span>(<span class='fu'>quote</span>(<span class='no'>year</span> <span class='kw'>&gt;</span> <span class='fl'>1980</span>), <span class='kw'>vars</span> <span class='kw'>=</span> <span class='no'>vars</span>)</div><div class='output co'>#&gt; year &gt; 1980</div><div class='input'>
<span class='no'>ids</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"ansonca01"</span>, <span class='st'>"forceda01"</span>, <span class='st'>"mathebo01"</span>)
<span class='fu'>partial_eval</span>(<span class='fu'>quote</span>(<span class='no'>id</span> <span class='kw'>%in%</span> <span class='no'>ids</span>), <span class='kw'>vars</span> <span class='kw'>=</span> <span class='no'>vars</span>)</div><div class='output co'>#&gt; id %in% c("ansonca01", "forceda01", "mathebo01")</div><div class='input'>
<span class='co'># You can use local to disambiguate between local and remote</span>
<span class='co'># variables: otherwise remote is always preferred</span>
<span class='no'>year</span> <span class='kw'>&lt;-</span> <span class='fl'>1980</span>
<span class='fu'>partial_eval</span>(<span class='fu'>quote</span>(<span class='no'>year</span> <span class='kw'>&gt;</span> <span class='no'>year</span>), <span class='kw'>vars</span> <span class='kw'>=</span> <span class='no'>vars</span>)</div><div class='output co'>#&gt; year &gt; year</div><div class='input'><span class='fu'>partial_eval</span>(<span class='fu'>quote</span>(<span class='no'>year</span> <span class='kw'>&gt;</span> <span class='fu'>local</span>(<span class='no'>year</span>)), <span class='kw'>vars</span> <span class='kw'>=</span> <span class='no'>vars</span>)</div><div class='output co'>#&gt; year &gt; 1980</div><div class='input'>
<span class='co'># Functions are always assumed to be remote. Use local to force evaluation</span>
<span class='co'># in R.</span>
<span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='no'>x</span> + <span class='fl'>1</span>
<span class='fu'>partial_eval</span>(<span class='fu'>quote</span>(<span class='no'>year</span> <span class='kw'>&gt;</span> <span class='fu'>f</span>(<span class='fl'>1980</span>)), <span class='kw'>vars</span> <span class='kw'>=</span> <span class='no'>vars</span>)</div><div class='output co'>#&gt; year &gt; f(1980)</div><div class='input'><span class='fu'>partial_eval</span>(<span class='fu'>quote</span>(<span class='no'>year</span> <span class='kw'>&gt;</span> <span class='fu'>local</span>(<span class='fu'>f</span>(<span class='fl'>1980</span>))), <span class='kw'>vars</span> <span class='kw'>=</span> <span class='no'>vars</span>)</div><div class='output co'>#&gt; year &gt; 1981</div><div class='input'>
<span class='co'># For testing you can also use it with the tbl omitted</span>
<span class='fu'>partial_eval</span>(<span class='fu'>quote</span>(<span class='fl'>1</span> + <span class='fl'>2</span> * <span class='fl'>3</span>))</div><div class='output co'>#&gt; 1 + 2 * 3</div><div class='input'><span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='fu'>partial_eval</span>(<span class='fu'>quote</span>(<span class='no'>x</span> ^ <span class='no'>y</span>))</div><div class='output co'>#&gt; 1^y</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#symbol-substitution">Symbol substitution</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="tidyverse">
  <p>dbplyr is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="http://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>Developed by <a href='http://hadley.nz'>Hadley Wickham</a>, <a href='https://www.rstudio.com'><img src='http://tidyverse.org/rstudio-logo.svg' height='24' /></a>.</p>
  <p>Site built by <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67989-18', 'auto');
  ga('send', 'pageview');
</script>
      </footer>
   </div>

  </body>
</html>
